// keeper/query_server_test.go
package keeper_test

import (
	"fmt"
	"testing"

	"github.com/stretchr/testify/require"

	"github.com/cosmos/cosmos-sdk/types/query"

	"github.com/burnt-labs/xion/x/zk/types"
)

// Define the proof data here to be used in the test
var proofData = []byte(`{
    "pi_a": [
      "907018191609869776483146231756308064245093269246123248161423089998091186781",
      "14679889310261893625845727150982271381319864224926217577936343417643086182093",
      "1"
    ],
    "pi_b": [
      [
        "11137492206274289714379015350637368473268597751699619711060679283543612941861",
        "15255303892723164342905323852508145977447212107280958058997342546767120185115"
      ],
      [
        "19558335449052206516225504113249324307274242315727556291081415759148250092400",
        "340078880613600119033146941463447139158558786485597856144317965124730538389"
      ],
      [
        "1",
        "0"
      ]
    ],
    "pi_c": [
      "7786748835093235474770079624661619904035768501970455231205852831661688787079",
      "3595524139419799514451131632083624513600280382213890049701470214844279718547",
      "1"
    ],
    "protocol": "groth16",
    "curve": "bn128"
  }`)

// Define the public inputs here to be used in the test
var publicInputs = []string{
    "18138866518273820648052251188851143806204622579513049686923680549205986413638",
    "15212984321660822893227585878110360591373764680524847926452803171934704894739",
    "7532393484780245196631281087336280917688639190268760398486055179167560678840",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "5299619240641551281634865583518297030282874472190772894086521144482721001553",
    "10031262171927540148667355526369034398030886437092045105752248699557385197826",
    "2763488322167937039616325905516046217694264098671987087929565332380420898366",
    "12252886604826192316928789929706397349846234911198931249025449955069330867144",
    "11480966271046430430613841218147196773252373073876138147006741179837832100836",
    "10483991165196995731760716870725509190315033255344071753161464961897900552628",
    "20092560661213339045022877747484245238324772779820628739268223482659246842641",
    "7582035475627193640797276505418002166691739036475590846121162698650004832581",
    "4705897243203718691035604313913899717760209962238015362153877735592901317263",
    "153240920024090527149238595127650983736082984617707450012091413752625486998",
    "21605515851820432880964235241069234202284600780825340516808373216881770219365",
    "13745444942333935831105476262872495530232646590228527111681360848540626474828",
    "2645068156583085050795409844793952496341966587935372213947442411891928926825",
    "6271573312546148160329629673815240458676221818610765478794395550121752710497",
    "5958787406588418500595239545974275039455545059833263445973445578199987122248",
    "20535751008137662458650892643857854177364093782887716696778361156345824450120",
    "13563836234767289570509776815239138700227815546336980653685219619269419222465",
    "4275129684793209100908617629232873490659349646726316579174764020734442970715",
    "3580683066894261344342868744595701371983032382764484483883828834921866692509",
    "18524760469487540272086982072248352918977679699605098074565248706868593560314",
    "2154427024935329939176171989152776024124432978019445096214692532430076957041",
    "1816241298058861911502288220962217652587610581887494755882131860274208736174",
    "3639172054127297921474498814936207970655189294143443965871382146718894049550",
    "18153584759852955321993060909315686508515263790058719796143606868729795593935",
    "5176949692172562547530994773011440485202239217591064534480919561343940681001",
    "11782448596564923920273443067279224661023825032511758933679941945201390953176",
    "15115414180166661582657433168409397583403678199440414913931998371087153331677",
    "16103312053732777198770385592612569441925896554538398460782269366791789650450",
    "15634573854256261552526691928934487981718036067957117047207941471691510256035",
    "13522014300368527857124448028007017231620180728959917395934408529470498717410",
    "8849597151384761754662432349647792181832839105149516511288109154560963346222",
    "17637772869292411350162712206160621391799277598172371975548617963057997942415",
    "17865442088336706777255824955874511043418354156735081989302076911109600783679",
    "9625567289404330771610619170659567384620399410607101202415837683782273761636",
    "19373814649267709158886884269995697909895888146244662021464982318704042596931",
    "7390138716282455928406931122298680964008854655730225979945397780138931089133",
    "15569307001644077118414951158570484655582938985123060674676216828593082531204",
    "5574029269435346901610253460831153754705524733306961972891617297155450271275",
    "19413618616187267723274700502268217266196958882113475472385469940329254284367",
    "4150841881477820062321117353525461148695942145446006780376429869296310489891",
    "13006218950937475527552755960714370451146844872354184015492231133933291271706",
    "2756817265436308373152970980469407708639447434621224209076647801443201833641",
    "20753332016692298037070725519498706856018536650957009186217190802393636394798",
    "18677353525295848510782679969108302659301585542508993181681541803916576179951",
    "14183023947711168902945925525637889799656706942453336661550553836881551350544",
    "9918129980499720075312297335985446199040718987227835782934042132813716932162",
    "13387158171306569181335774436711419178064369889548869994718755907103728849628",
    "6746289764529063117757275978151137209280572017166985325039920625187571527186",
    "17386594504742987867709199123940407114622143705013582123660965311449576087929",
    "11393356614877405198783044711998043631351342484007264997044462092350229714918",
    "16257260290674454725761605597495173678803471245971702030005143987297548407836",
    "3673082978401597800140653084819666873666278094336864183112751111018951461681",
    "19887023938730894427143794948575306355011582017196671014872240410603459597120",
    "7068268213071391973967486954023898159456537903405480079796001296565246874960",
    "3509636763931186775014057633087577369175102471373935940417392511021017595425",
    "16535134103725300968607462040559360848171896848761014323482421714236425608265",
    "5330478066344139935436436127341881301276543888261417148049942448818305681594",
    "12456201039634550836795232089190464832152556702312212487469441155647382416048",
    "13204893887327057045362202651995373668938821313846071433803052432740991672212",
    "673346635663251372369806494478114492234222514616780011067718175823449805735",
    "2994839905809556042070518838712616071541587248941989060306303889263588388255",
    "11097750534152617643340062706675709211577472024717509943812613077758318924106",
    "3771503457062273271546016300093230553856593472302784619780820958967554775951",
    "19444729869121108279470509035379000656070204812127870047595757606288353234423",
    "7214114395567604086665901707754817922481418978834878134099789257964669241647",
    "8544190601775216220078799838931978462197645461624194337475442150667027937342",
    "3379730964663154874527836716278717594511812043692162915519740791388901320718",
    "11554358906082256820156542511832335876877631083405015837828503674751005895307",
    "16429497577911412009624281656685486780083244068323404118664763338372251002487",
    "9888371980005267267751454885619148682045022253444409323976153071437802319389",
    "18821630746377350791074725038222876321628834128301885640872545694935344278566",
    "1031691970092502183399944353192490503225247154271943152919542227993132836779",
    "75574275282879409630917718404238722070695122899076250751420821810111147480",
    "16112611529102028899726365751243227627057010050035413747595246371826166531369",
    "3029169172427082777028789482291222616352870878814411362361869940348554510928",
    "8078835896155183918537919327425573634745502569143880659863881505316756187940",
    "13146361575065615519841825541009991622503708321926065095519455136750110377253",
    "17830206830379557197827586939971065070899639367266637089311799953740671952465",
    "11768305032570126931795538946252618155638200070637960448183312306560744466084",
    "12264725605954458116830961564594107354286531237929214015939863845513782384015",
    "21295232346320907906699224190293613629416890448914760190308451952201074942072",
    "3825404281272820770121885605583057802114752768412727219610220447658520077711",
    "1874959290842632069745863708127326449534174378680005116410358046244687069892",
    "20650698353040684313847025703656226036366663419373440012216464740933521632428",
    "19677350262687354732117960468020503050910965170424674852899925053800936672007",
    "19657909524716499662268652782515293963305915431414817369073349977462123385134",
    "16965209106344004121971607376192932942895815313599783011495286907099444262179",
    "12872048377653091985168025629270899587700582884130304746308341436356161805794",
    "1959343758541449581684366273967706594523567230194097450254931646984049359439",
    "3561893436408532664053053245260307689663880728802070010112340365863395764265",
    "7614111676834165235533346068240896707418353507843108394175401424899951627922",
    "13566035491825447197827086163566365191857460972729342368081422249914417811604",
    "17704078792857465906078908038006826812464974888985017799672651066084960524430",
    "20425411392207811402781354899886429325163306076874237510583820159616284194448",
    "4396308251136496952859236720395793022686968317472103856933303433168194149143",
    "5127249783062658067271719140688394819236089566539877434740047486489685220408",
    "10757924677801445173613074375881568632854444215832950072661965489659703111949",
    "17356918687885809598276345252852453022394167729053618915754820916296939231802",
    "15495117547327842922192205802659593354989292343836034577506652547148604251409",
    "16645017313683191976313265111738680332465474779710404912320327921812882067266",
    "1028578265612417745051784764466002498925137239227936620482019237514733203383",
    "7487685663969371810893154887409780799855295759875866291038000784265153584428",
    "8647183295439590462354438996017370144274052228193921602293042659141010934144",
    "711575402888973791228640150939011804268780803532661160517792801452066091514",
    "2365941146960089835828956259827954545415666325479011448740994646218947100290",
    "4110094666745784819443835598644038379709938601850055497830986400273352456427",
    "12643388779614458229938591834522348295685398288788127731343683086720076423521",
    "3956615860653702599803376319344490082289996848084134080439557250039004633075",
    "6406151862644355632303194432892508048305436483470340161414131483181921192290",
    "7229948813391712194852520574963577172110519284320956320902013860248708835894",
    "12465897004378579408675689522021540250949375349431956435063586497135972043814",
    "19480191525325418728631360512598439185045498407993908278655541000816337673745",
    "9309160821891664152046239939225153246372773537458777025154541004945546758706",
    "21636361285732377321929497754698190953510070131091309149805907457577425273394",
    "10225600038752741410015358825550742821368965434565960624472702836839585914970",
    "15952644643292662981608975517058588469878690859481892635212255296303202426935",
    "2412315204595964468539201221654202676025828678508920639878633185970646261181",
    "9152464444118880273922117876648137303112569663546831507464866140632334013704",
    "19183851685045325765523704771123470875073611633480925452500293143524247808649",
    "13807935511470787191142922136441499250286374002485957831133446573223303070457",
    "4343792112199035334806881687258907958639287212004211251851148106523432843932",
    "19792160569214994446028175235137955649117817141149771283670393699983534111542",
    "11450482652034369668771273396659960687905837864293005826020939979989809138977",
    "18847497026278522862527313692597763267711062591483554085979679498924107536453",
    "468110565021239880053957080493436243592204958867909220218062992725071500184",
    "7439554120816800529444222732763708732273455399992807934594535328468771645578",
    "11226775468744703642891402978723220406404607555401069410127731202276722622656",
    "6319054777197785415236734898352645518309409214085319374315405047011675047599",
    "5224310051489350858834380979341951400774734682909970030909710803545062784183",
    "1075152009004771049770516070207538706923360720478468661573633627680191799242",
    "21072371773204190322408169319931661000002552395204679009627605241426989584576",
    "4192483274927104977648689570546671905176976086446455609303682933388081772819",
    "2232570254177546118734748417236372613740953088173064928196264337600226379729",
    "5260659721495454662468045835582516796140678624116885683982203624366236799245",
    "8035923556641424495683949506257434952894557164047067565267357318928483371989",
    "18356949604973845002211768540105581819948262328276762460218240755777658281849",
    "12176761223470973662889055629470737762895869140972573077470849974005686149889",
    "1169051655643811705535558915005606860872835779562045742763437729712267832188",
    "5326803063916315274729163981727901792265404377940367095728516557502557698794",
    "21810927848720916261345525711824256082513055294667952507359617051141589749726",
    "20998895600917398770762413689003060879935063890893948883858920230395358080638",
    "8404153040881162321478292943251809115004187595128298477804296787291170001417",
    "5985344746223452816886533119327668919692689072191064639112090150419026812460",
    "18399348140915412803953878587836065636119379281105157977250349388612701277012",
    "9357381696677700223612529212285913728603905591374021591441812585453089722881",
    "16938855651100479400095836858945429582286828080490906243953232741551419412425",
    "12538160224453464845118691516404969923391510877619908438598522721872551856001",
    "21390919907625979856328387801560094674924880073758935287812622550422257839973",
    "19973869215451504189199308458720125114260415634214791639708752261159192128012",
    "10412092488477245248016763086112892498869486353405669871432532850049141321462",
    "13081263890433199550176021939905746015773062848809384337966207600204651494701",
    "1487429522367262177210620922790885257598614187056853321724656695757755280381",
    "12708666739862869115713970995315975662756706980581585370691854964039896781797",
    "16506791435307668276992714007910154584620376196518483260284722812321346577647",
    "18385298574432042482514032368596342432591117592212378876346790409963256316066",
    "11036147288432121997602525158487789671045212147874833706033715275269104215186",
    "4503599627370495",
    "3075935501959818",
    "3902801436977097",
    "2724001214845611",
}

// Define the vkey here to be used in the test
var vkeyJSON = []byte(`{
    "protocol": "groth16",
    "curve": "bn128",
    "nPublic": 215,
    "vk_alpha_1": [
      "14378794661994809316668936077887579852844330409586136188493910229510707683568",
      "19007180918058273234125706522281291487787880146734549337345180962710738215208",
      "1"
    ],
    "vk_beta_2": [
      [
        "12055325713222300848813253111985210672218263044214498326157766255150057128762",
        "5920706861016946300912146506670818945013737603659177373891149557636543490740"
      ],
      [
        "14277278647337675353039880797101698215986155900184787257566473040310971051502",
        "9700420230412290932994502491200547761155381189822684608735830492099336040170"
      ],
      [
        "1",
        "0"
      ]
    ],
    "vk_gamma_2": [
      [
        "10857046999023057135944570762232829481370756359578518086990519993285655852781",
        "11559732032986387107991004021392285783925812861821192530917403151452391805634"
      ],
      [
        "8495653923123431417604973247489272438418190587263600148770280649306958101930",
        "4082367875863433681332203403145435568316851327593401208105741076214120093531"
      ],
      [
        "1",
        "0"
      ]
    ],
    "vk_delta_2": [
      [
        "4749829685018394265759166642612538661956358501586333301117677597065071307926",
        "15804720237715868904774198384823876758005645387467920325598801085788769080458"
      ],
      [
        "17825137562998211765453733883587501412475900254697329097023879297167891750509",
        "20902351206911412272267116072032507955937033537640638451684518277053070440214"
      ],
      [
        "1",
        "0"
      ]
    ],
    "vk_alphabeta_12": [
      [
        [
          "2552340398560037553466474334090684122239527938678075120685238892210140286734",
          "21103567520735181525962881223829473150964899590725643730870360165680654169821"
        ],
        [
          "17418358945522398631235978744064871659729272245932523041719658073201063889547",
          "12780865215547052197001378227425221956514050662134427990972566538059532319392"
        ],
        [
          "3101120494865128027437311952527045792832484453316657117057089254057743545356",
          "13276054897685369681716779310142237353869839733892907342519192250312681998635"
        ]
      ],
      [
        [
          "12060095829229916424462012554449507497737260384521108585857034955753024275809",
          "4186390213203745233792740144907090174162444102454343802205404423496051058966"
        ],
        [
          "21194213978609667410351384442332026901277069323933037611098337364518057338726",
          "12340070885078667797645127498544657281686947867858979354578727773053815409164"
        ],
        [
          "17244726363072569657630996237856400482385700697899371994592682207921269901256",
          "723363160021531292090447266088967357211629759196476148452063353646061859464"
        ]
      ]
    ],
    "IC": [
      [
        "452987554829437481229946320777014200489823354620417299261008144880501532245",
        "20588611611633716068717973072126950304472046696263395535824873728340460492870",
        "1"
      ],
      [
        "6126369430870011783898934313173628831869220754713760114240402157400350132910",
        "4225470032729069326506087575082120700076142098168844838071648223636876879262",
        "1"
      ],
      [
        "50479399711007998946374472570799911197543352622925801117841793184196870141",
        "6660715107116978597654608280731609126766789580894753485097172688965554680346",
        "1"
      ],
      [
        "10645881551741033904162074869683205934680250437205330136681200260809757191238",
        "10564704444086989525221646723767207913615488805442243599327818666414025363108",
        "1"
      ],
      [
        "5328466716976026957002457909888397138536453544531916991876534405442662975657",
        "12940879501493515153665647259593131624222444893552424756329668432949401550511",
        "1"
      ],
      [
        "20621973199298281600941465795290150562537052751025030113306960715467792941764",
        "20422802931522695914359510694885504614417305973665488819881684816712591573582",
        "1"
      ],
      [
        "1764283856582817963552052865427272364537522956314493348594242094072646114757",
        "12432746687543590387095921614554528597628627315166579696768400087372688435102",
        "1"
      ],
      [
        "13390976395853137306786979579844899017171373492308361561981011511517761248385",
        "6714946143107216347907357561871576757271968337330750339329063007116347761586",
        "1"
      ],
      [
        "3101554795368135523452882365118260859564178589971314623229778897304568457214",
        "15596346270876469233310635536187885136525329054720448406679536705573317802972",
        "1"
      ],
      [
        "11007336989145996130789044651897953394561365486407189135080781499165496058544",
        "19996442538518941007039558555557397076531404569806590635921056185511030305220",
        "1"
      ],
      [
        "10905096413227544111061097063180112134296876490375651960481421442588255864375",
        "11783370234777013392717331178288130160893090490713725282286599472099040913133",
        "1"
      ],
      [
        "19128514327328933493721952285959725925996454789798013319125037068164767060083",
        "5428049426951372838522234466772658641883235607159118773728022016916185188399",
        "1"
      ],
      [
        "18706404340525899852936562780319551173123858883796240764060751687856903973445",
        "20604796686248985275326686425042133427466113409155566772706621358991867302350",
        "1"
      ],
      [
        "19848481362546350494066121463820778608148785727361260138659341902812019929916",
        "21867229820410363636459395174367757791884820439067831467959916325421711976669",
        "1"
      ],
      [
        "12351852068222618849602292315937958852818457763197147613635273740678497634435",
        "20048803870581863938352468970552153898483212167188115862517479912098297592243",
        "1"
      ],
      [
        "15379808828479104711527790850726385007735497039619578940884699387870922254531",
        "10168227167055259148062300077780945765214842142626533292756349045614073684733",
        "1"
      ],
      [
        "11331990375532492790427763037069010879885673443827351354562212991733945370831",
        "21586236632840665135167888358664402923772789915388030512495879630116346499550",
        "1"
      ],
      [
        "7054222070294618571724642157384661847125276157456823035211633466323806627903",
        "9231118965985692191583541505569554833200207720441196952001685967691851992288",
        "1"
      ],
      [
        "16704009658286049419111930436135116246496240941835645935328418064761033164185",
        "10043802721428886139114123451833876311868052224040108157653262366988023787645",
        "1"
      ],
      [
        "2656886722929079249881394958945544884853385497104572496379378343111810470188",
        "10364218707906830216477563130483985035252147998470574490827252732695559236531",
        "1"
      ],
      [
        "9558348933648571468299830182104904180170501445361297098430680332648817283347",
        "2273940470913772551291402972330942466309826531457566144465448663117296452763",
        "1"
      ],
      [
        "20336207658852767624402404767405586947225969574174141912812109265080056019811",
        "2963880459083175891412153109478614209938396612497396264159259557008191798317",
        "1"
      ],
      [
        "11878044374868207030085573421592066583217091526945525428099690354756867723799",
        "7063516920001485334175271837288685127069551074579723794937589878466479164883",
        "1"
      ],
      [
        "21648559892486881055159871377524698698952261266323448506734745144778090437303",
        "13416645216305323412337404474733651797168660322656724772201346958100515837785",
        "1"
      ],
      [
        "10584861656881708777110775747692047096815755326949921957340568014180808723050",
        "15996479741960630643953776888340825819934697249463232786473395814016021500836",
        "1"
      ],
      [
        "21286180561863119370386463912691348361504240647053702651932936265058893129492",
        "1105491093279551124225141554725567845208603976533430046757201312046791772821",
        "1"
      ],
      [
        "15313655766904868225829975194569056983308232820914150832919464130461126177757",
        "6227368225994678468053381123064307984458604240959228922327584912841875249855",
        "1"
      ],
      [
        "21443340353392977072094986286878878312342171274204355764850791121944494254877",
        "16696138049126985531185706832292819144326810370832946685372049988709797606246",
        "1"
      ],
      [
        "13001941544234457940845015753225563947709404785152566328706086140499801796219",
        "6899350556086910097340816219046754474155952427017308221633449731482897673416",
        "1"
      ],
      [
        "14251426002892795099293500450341533162993218015270489386569324163101517528193",
        "3991495684065216474361977727160864407270857790205361554486941224146730640205",
        "1"
      ],
      [
        "19543118808372428107388952488780421074362659789161084540928610122351730229873",
        "92550720200846021176593882520255598347978536788537192953630249889247716411",
        "1"
      ],
      [
        "5432324113206826419052660407212086991839135188591904507277232723429091012321",
        "11467978453887233360343515545860893124052154619877379915678624300372943438222",
        "1"
      ],
      [
        "20969315257936142534989039576716550425798085158034809224402015659531463933363",
        "18764794657165313485283779801385834648238385455594639839173743930560328690726",
        "1"
      ],
      [
        "10947765444249494726119500093732190113650014954452467461220409979030417506187",
        "9578768902173291851910706722331916952034848815612122648574285390030392409456",
        "1"
      ],
      [
        "3079704637914380354184296307747461302231522314796415531991237401866757634208",
        "12424712540041715669019160747610601864097297252810461312941390683136552470803",
        "1"
      ],
      [
        "17004561612458535924238993285209307950077220691016025354465243743530429541135",
        "8018367730084444226625178308476605659816398346930286542133352972267524027131",
        "1"
      ],
      [
        "4683873821324794382612092298974038457535199227051019180466735709843819208246",
        "1538456770134395251525076284352681561311928298891034992019070087281991580820",
        "1"
      ],
      [
        "5227791591558443831416670880131485177384905050838002458594694252673745590331",
        "21180384934024153548394577620762421807714292848474568207573088776243969784034",
        "1"
      ],
      [
        "17562482600119071884682739464040428897888895575611303834868500221073376189834",
        "1867393151725347743855630327958330327341700462697090633836618909475405863034",
        "1"
      ],
      [
        "10678994881195170949782788493895414488654592319353987441046737745441640118668",
        "7930950662540518562653020629143072217831724960065756378273826226558816427432",
        "1"
      ],
      [
        "7027457874291921809379323126702389276073321145892713829911461028839047899436",
        "9677077819758341155141989676969046591388076871318794473804491442710260069666",
        "1"
      ],
      [
        "20719078579588124221495339462305579267992137692699971129576778036287640218599",
        "20451120309324107407506527228304953468163509954137440191952154322658275289955",
        "1"
      ],
      [
        "13679107044664048649899812766462819300763178649996675006431745445902550032154",
        "9222889857880975045895570254878175569001189342060660751952967157619747710178",
        "1"
      ],
      [
        "13563509352876866209387751403010327795382054252450863868857301609952660267097",
        "4107333481832477524920317593711990114014667410489763008070869111494085329442",
        "1"
      ],
      [
        "885789169390329294619874940833751880490855727879747547876615435372263424423",
        "1775078248664753744544780363210308428990387360741189122864426314361027278016",
        "1"
      ],
      [
        "14695369349133728489990130703814415305064250231828117017459199020778072594736",
        "16566602047767557614950810141865611752985610977390817978630024213702179640502",
        "1"
      ],
      [
        "3917504453495221156268180428760176085004007052090851843584283383265218543569",
        "13968795499269201034635964537695810406703037244384932127886892380995550953536",
        "1"
      ],
      [
        "1168035972860135435344138424391854251712036437888863404324968990010363229789",
        "6203100166531660730756264481842760327439447959795515139189754790364141553423",
        "1"
      ],
      [
        "6011503913203282648232325956336024145116029811015410887727235939794791182321",
        "19064243944633879663635425319603100455668076152986530869952108114530337731557",
        "1"
      ],
      [
        "17555819367486770413240961167318183407205525718841386705694027901212000996565",
        "17454264707343667309504025459459355094981651711453614978158109001401528160297",
        "1"
      ],
      [
        "4824699235268764024556627253498557621115200830627766760654831900325246019003",
        "17312003454275192642340451830724935540804838754930809815642355714976414994253",
        "1"
      ],
      [
        "9333089741411141264644404641347504544810414116257972222175716806978000132331",
        "18725687348736768386854114453932433927333581080637146300294352957900736587463",
        "1"
      ],
      [
        "21774964624705660467735130632072036550648278330539894823272979435719667297069",
        "10428365881182552473120214016431558216037018603089842360255436597227528983987",
        "1"
      ],
      [
        "16144689706154564793490842148088265643309395009353095634356335327292913561850",
        "13604013990605877878221446710986569710840175352995801600650374421686561134599",
        "1"
      ],
      [
        "21807079438300550379757698556990224927312510559558706942833849986012450013638",
        "6728249490725054732236901132200962304523900250165202642491319185040994927733",
        "1"
      ],
      [
        "20379715507466960566868726908408815258432051658701840711708615997884817954310",
        "14130642783273589985101232768532484819331666122620317024659565639717137092762",
        "1"
      ],
      [
        "15295083391178420166967070133861436007895352690149084727771431831459964427017",
        "10681826183969024618404916550624054959101583969372902023709687826575573343131",
        "1"
      ],
      [
        "8059610141493125181067545941017599107224102076516797741138493241413206887537",
        "15468407131091161388366464952841796216514652993035165820259107226606686582219",
        "1"
      ],
      [
        "14059042112719502599450911022747679384060598254743945538472409354625814594572",
        "38518076542593066660746695442933146537392203174992539396083782800912758908",
        "1"
      ],
      [
        "14092028957597392891730827882742574081717605904024593431118092129868411666124",
        "18869809128962397577950321487645294554425160222314035627536223839311475972222",
        "1"
      ],
      [
        "9183025336303473127339179263012548399806355509893176604106152146450997713580",
        "2773152783109797908591055753548465661785062780694941405290295118388318168987",
        "1"
      ],
      [
        "20761230760115273527160834182251981967957586529934027372372428341625808039691",
        "10596871548967029862429823274003014824674218207948302839748548666705482908010",
        "1"
      ],
      [
        "1209973529233982162131797482357731198515499215085382183805796912668174195844",
        "9321088649619916462580628561811567105914122739114521832348583754106225410176",
        "1"
      ],
      [
        "21869749798293567312520491048015123535575669604111777996848968874201190469282",
        "16761133094701937591992828757557699450843068870822295097614115310129137252907",
        "1"
      ],
      [
        "18548858544949725689037597377289844940200196983979251609291262273090449127046",
        "1008459005555762877861212717580563943646519563711418478872366995374217116713",
        "1"
      ],
      [
        "17609032551846702359978149019578358421367513583579623209644305360780943365321",
        "4204975348605972348678935396216286456832836283485338924763035867850059776169",
        "1"
      ],
      [
        "1753932744414724585154841303718745290957803012920974086493397327521144796762",
        "1683695898741002734696860909446865253597542984386584674978409153328682863529",
        "1"
      ],
      [
        "14199332382881375671276825981171035584510020456043442236826221713953845458753",
        "20484254846464807434947750829112468237775796558938655017114556815274832993994",
        "1"
      ],
      [
        "16334726862963458724896357664408131695356807715674434934567889994796384247255",
        "9211488826931978671235855903628189827577438486231198304829464449818951791260",
        "1"
      ],
      [
        "17482366026711985074102984248270548366844796378999981782059935151196984195067",
        "5367575761607467623511465005894460598079195574008115056228189634080256918191",
        "1"
      ],
      [
        "2017081431057134477843607152528975061165081425689278391865885278233467511227",
        "6539080273179444171033564196389305563261483012815322778994807860824858257486",
        "1"
      ],
      [
        "19632931395712471704590165645783536457134890249520801449306777058656698232386",
        "4094391571201699120652719954061449228645891638772729268832582916784926479119",
        "1"
      ],
      [
        "11490666708142682017958378097512940205332248616511569078975345789694945225569",
        "19526086463445226767579712927576558866312139770291151393527207779241033699967",
        "1"
      ],
      [
        "12682886174263590610982424936639633123752656814885742584209589756036170331905",
        "15883016965245835425672435941556533466780735731933863427331294860427200753640",
        "1"
      ],
      [
        "18891379702153872823491570928525122097283493942587079172296634257353775538957",
        "6090592970237124414517940228702919587450542377431440073265432137996624618007",
        "1"
      ],
      [
        "18474034503952795150614596559813405947139901852955523487426189145536435555332",
        "14738655886877759788429763182943070437197259186934051052313599074706289697211",
        "1"
      ],
      [
        "13894783221288209808679467408511502299053003404779724533858345984957201300263",
        "5040175413718054108536381814782180358019719508135219811608860203272979596786",
        "1"
      ],
      [
        "10880052555248934698620631974023880919809366462699784031523227085707751556117",
        "11356453660264193248494471532392362151689275196752000792150348790221322863449",
        "1"
      ],
      [
        "11640681998678672574784280982993478331299513270547476522326908485436975671930",
        "2954423156528883085989084613922781223815593664422338059020222308170112791955",
        "1"
      ],
      [
        "11291693286990316491064085501735638543403082163315360472043665305405670377473",
        "17438688265204106568413268530497876473907544039765495213847044420411814318156",
        "1"
      ],
      [
        "14943594624175503204203632744650644645945984632803966726231897900797592248624",
        "15902574245838336656052682656458123905460582263718535669274757144641099560343",
        "1"
      ],
      [
        "12098385596360167918961280801438160120086879419903340653182675471082854736896",
        "14863584102872187983358917586275777172802954675420947104402569363472203235616",
        "1"
      ],
      [
        "11602354982392575076379892597743923587246578664013455820292832504707281954976",
        "4641425354044445790832711439944642261698747349549539370194300791560917590380",
        "1"
      ],
      [
        "14382427808542708908539010293898586219861726572527740205006069924608331574694",
        "15087792687025742937293300211507148213026795487922483830645082826203626699889",
        "1"
      ],
      [
        "14361002678380468161205137444398972748308152534313031773002118810671182803556",
        "6258747919849270520987585820150835222186581555468746420460415794200284831282",
        "1"
      ],
      [
        "20211912835886133679120400453253441749773848732489602698990810102567475713793",
        "7208541552267603399614055730710757458332909110854616719478508650234821690435",
        "1"
      ],
      [
        "5658659821864447582470683978437318384940339819576249104925467422243942102462",
        "3286896671033162665856002821157136578689192034227669965430656483607741558023",
        "1"
      ],
      [
        "1144656847512744289557080915721868573837621516520720197463693074322948818529",
        "1647022321862283100580243964646789439914568543663872857593726073449836320791",
        "1"
      ],
      [
        "1344532008253636668178013864788433868087117795471215921394276558957764343013",
        "7687179027074195851537500465215292671682971914489184578463327534186538322566",
        "1"
      ],
      [
        "16563584910876814815065156635258885081131972207953306144264746720454222345828",
        "5800307607854453278758171463976847858384787424571821914083927385939851055258",
        "1"
      ],
      [
        "10033809278188554663774468409353984742740216156968850494525903372362547677182",
        "17862684449533638262002756557990367640337282816391636361801398184101068909353",
        "1"
      ],
      [
        "5213244948797297588008404750127298006860218555892434121974076969189741051378",
        "21476729206532562683108887848389658065726382388857297511188663664024282193942",
        "1"
      ],
      [
        "18522951819225297888574896023503954191694182969085930253841428621252901622251",
        "8925552714702138270432174615681456281207395138648675923805088673576248128554",
        "1"
      ],
      [
        "17888898527740658764022594001864800844538090035873511576233959798427453362794",
        "4449542211158129469651423470185378712174194398767928858921019856583223647213",
        "1"
      ],
      [
        "20045125277699696266846838941366419796387023598416158243616434547289594952548",
        "4661259934614559518933217558073284269306432739915234318880253258262842506218",
        "1"
      ],
      [
        "19154909735852037119163540897097565494560798157939351124537201596153864792416",
        "17732452714941833062987442980719677544934685540478985408939605624275465328677",
        "1"
      ],
      [
        "17751232779768423792888022901987142003023040220845510980132892776503165095996",
        "4260923995425364157620360553936020876180238612981181207420145068748974552256",
        "1"
      ],
      [
        "7302887048260639199846134898046558105470692866320472420800549751501367548274",
        "12630360085931835927534554531573725955099307079491343313230810193884163820210",
        "1"
      ],
      [
        "4875332498272585441963803581595820868905741158761540955417932851454587933117",
        "6211439615231052354153942724966175200320931109735020458108992557732011618484",
        "1"
      ],
      [
        "16089763203753964644426458115814863493533959735145987495394797577660371779720",
        "3274857298322295483280602688349252113754159231301518128324889278219143393663",
        "1"
      ],
      [
        "3124700224850015232083191858816829016910466628216369302447011595548237258802",
        "6211545510850411799289679129315184082256966531070929064302041985348315781852",
        "1"
      ],
      [
        "9100256133373142600522970945170827300024895368365385952410598820311659854079",
        "18931472625744312105267749284139214444738247977241778358567257121234031949890",
        "1"
      ],
      [
        "4820865921572139486584017706337039037032942317781714667446537405456709928031",
        "20984312689634782522639931755742814589830831766102678240227594720710939992951",
        "1"
      ],
      [
        "17826729265314130559815673607120669259461033375723859562216591957362172701767",
        "9656450386303477582008999738591642900182491260288824022635294015541372887452",
        "1"
      ],
      [
        "4456800013196131522909077566754296829875674053977812233976410533681425295613",
        "3617386484384864696589682441482141599176490177544180426955178986570806788396",
        "1"
      ],
      [
        "8316065484758118537296493108328649728700892751559468976402290280101490385437",
        "13008930648944145203365144791067477806462683881612830156742470482084975500486",
        "1"
      ],
      [
        "13937763847022024014541489429469083825209246571816482110056051253987980879476",
        "11249900962255192056153704520323821400430004362438562670009070378021595605944",
        "1"
      ],
      [
        "961291012917931271971794869739902112966519374624650586935304387301317702705",
        "13349888783927927466442403904812987069093423830202583731066070811863033687526",
        "1"
      ],
      [
        "16364087689026751720771602138791637120362829080404696140942877816377965003813",
        "2192360571699289581848819998361554142714257753573107526161395541615337679030",
        "1"
      ],
      [
        "19591172000594208781214868889142170019164304217955921920158611358020631903399",
        "2253001156575716518162806927072031328458328285656897177505902711488581444021",
        "1"
      ],
      [
        "10061466828278257879940361290216783962552587469381995496504138157136699459619",
        "2084654502251231158623389108427596301104410727318658755886485404232265711982",
        "1"
      ],
      [
        "5047358973148378475587152882863946529002727435047293143520502313447860667454",
        "4952060746057681841993157379165890143617330651779698944343330359819957302296",
        "1"
      ],
      [
        "11780024181637587712156123131660746967372907787195815446123008021030216990110",
        "1724613473875111255233244223782287991056072511766758806549939533259538558045",
        "1"
      ],
      [
        "1361907449707758004430456723094953981409384618036880333726173557019775643123",
        "1396307300194695204560153775792215169475712217101611935571551073367694531648",
        "1"
      ],
      [
        "11623342184306533112780079170570912918230864247909273789617899324474502187447",
        "10888838535689466717983783465844383570701660389226337994275162849716129999664",
        "1"
      ],
      [
        "6124783859307595499636222170266461198066236620256318858241418939512690846210",
        "11654418425708266811153155440004903940468493436695057573773222233855590160231",
        "1"
      ],
      [
        "11976417498514914912750414175456702306843413646040221039062851247088509217878",
        "16555983317326734322100010817445636022281238681182715698078945752735647300082",
        "1"
      ],
      [
        "2132125313190147327663404604428015937967047155851912765512275238424484618117",
        "21746968555622091392044707814331772598114481548815781646306899891364029178430",
        "1"
      ],
      [
        "12935207606620261789628604340498957543368225283200775348265519430484862923793",
        "15626703104241434387356621988285708223335267637606857186773174684307705451642",
        "1"
      ],
      [
        "17010033523085371141858786798982360516022860077151037452736191587131050128276",
        "10773475930960370976671258275485863540716938004536607798474086138371887800439",
        "1"
      ],
      [
        "11953520675141112861456601737014076292697795937785251540873001131285555641733",
        "15281160025214167048777438284446542765985636029715530693096512672181400583657",
        "1"
      ],
      [
        "16191611928372768299576339789378804174936430974202255667438542462412039935317",
        "10355806009882081203497567560039478641028371740146166771772540085951272517633",
        "1"
      ],
      [
        "13799184837682491431697050623208976672331620471264961433710772593685879490265",
        "13359020907184889891156731713792728430546725199295472877205419019516125060096",
        "1"
      ],
      [
        "15166675180695060656671114192931173135204014172727306515377989962882871893452",
        "21469495051764234787689047584062952852856872883086109009603715799720503193452",
        "1"
      ],
      [
        "3651765441416287945242103931370844520138339909966493423413480413467015123888",
        "7789270080491911416202812116444065162144180412391910879286863365872016235583",
        "1"
      ],
      [
        "9600202049493185131597107207545083691083297113245371118516611632160919442458",
        "21264894863483302212261067128728119962842029613323286102120857532075491389212",
        "1"
      ],
      [
        "19558450196167284702394446749076871284947618845505633615571339824567490949328",
        "15003091635350863434975137286003691251614451433178331490457282250858806379236",
        "1"
      ],
      [
        "7974080208038921702505620890159450010496958876424222220856909763755349899499",
        "1490993733172674133484484532886822537582786211388003546436994567905033961902",
        "1"
      ],
      [
        "10635719247768214841315695362439142790482997232412125978040405684710712312400",
        "2225569268301799464379696667445579148029329257087947754954366162001566375239",
        "1"
      ],
      [
        "8835545015819348787491111586606461636755408196452145204886190876371477782402",
        "14580548763782393071951816523691657226064900482319424809042316763218135644855",
        "1"
      ],
      [
        "6424254513133546301512429464976612945093178636194485487844064189026729666889",
        "12849292875964890977495285257163556554043109884182961840889874663936800130466",
        "1"
      ],
      [
        "15525499786586004569901570021307444828439109711657257647726086328147099449431",
        "12770594875705854579005867871824286945145011691329082036049263133179917794803",
        "1"
      ],
      [
        "3896247763457437935464890907249105544282402713712968003301876351939786784823",
        "19643638561262224847942111729275254325534251894703689644539659166080739661499",
        "1"
      ],
      [
        "18354132189987467714578302656668192579350691639624993566431450159961623264054",
        "6293000185060651278673868417589876590883295756250366222554111875335207159973",
        "1"
      ],
      [
        "5589699283237403670721182977967951939878445976017576245404026296832369256552",
        "12494647520484999828497808984449357310307875851032425623192077895325795974448",
        "1"
      ],
      [
        "6388379047285030901905705039441268258166525962622990688883635049293616997462",
        "15447864842469611723999436313564614057071800245057264003997571804863915634366",
        "1"
      ],
      [
        "8814616582178744295319058691296049438996324760892120615036241919501844537295",
        "3374160408836466585827998258035249305307810651635917079919223865560096386646",
        "1"
      ],
      [
        "7604287612196893171677551068979464932837868245229819833423361353136300094264",
        "13775885269528921571678193491000591231304961261785105527398627779653659704915",
        "1"
      ],
      [
        "19948639476938281718506786480076898198356207066093853203242510428245812689811",
        "9426056835487540894127034608306746577816794810647620352539984396070002226536",
        "1"
      ],
      [
        "10143093369789834877912029466914067131591661377113369331319696217437592083336",
        "9968277411034720956194877222804249341905703687110141257703691917617731103583",
        "1"
      ],
      [
        "17992039382193877213326595696208530364369833167341524706992503176643448188232",
        "18136499695102421380679057624077607076834318902231369108244751555699125633666",
        "1"
      ],
      [
        "13232047845375834953989655162682827644394585840580566526293075973171593466715",
        "2015754000429281072793684822774000652413387514911611871210541282304129770558",
        "1"
      ],
      [
        "166100570821078282370343704430299601262430150499860458071579568572464281209",
        "19086852127486564029973662613890947947713600402924609840579680001985748926638",
        "1"
      ],
      [
        "6513669260004143824036564753979062367806481422616596802570283128562187362934",
        "10736456432529299366779568971552159399152675321254004827384573912415937895217",
        "1"
      ],
      [
        "13155400753621227950931113657654721391233748466177297217639885025304912434087",
        "444344396478820853542987743359220940065401968420184252853371130343799014519",
        "1"
      ],
      [
        "12131655806582516081066449464759929376840771653605274087031207636738251463577",
        "12266779625530438157794330297514101634174912354857165363078637505619583810455",
        "1"
      ],
      [
        "6764986963672950835323808001069553024465111331950890365410523298159297335639",
        "16220937330960945204787201819238794493105276523102877463807577721995767417537",
        "1"
      ],
      [
        "8063990216773789833512912791991455630597861006168623867000832131275458402261",
        "8351035125845670915110620764051882694934177668068329101643061480200604907717",
        "1"
      ],
      [
        "6789512153393624451869226206442608880307144029961476384323548122818220258381",
        "9043229831555588707239192803985529489265328620174685834418545584073234981889",
        "1"
      ],
      [
        "21491583690268259335781222616698604845689614783378463668793423699580073388471",
        "15703094010019503992721159210223968288467875778774531512984149825855756962585",
        "1"
      ],
      [
        "20827123246869799548408416955014407889526648394485443516613943631081109274048",
        "17173207941503994597107244766567415411027390421945245867691218724161106682376",
        "1"
      ],
      [
        "9320748993719286019448174601396836779704852183162977138730187957853927348020",
        "20424756982187516845636544614561606329577478841867978692299402905735489709348",
        "1"
      ],
      [
        "10012982625064082254040469110809541544633028062107765794802560244720346048514",
        "18558301311946030745640592155701455748932134115506966458088913396337554799324",
        "1"
      ],
      [
        "10913743175234292073765904343402756686355364528643883911330404635018026715819",
        "11290133208450880064856811213033875436811615524327032890939067197509649668451",
        "1"
      ],
      [
        "6198115563835388408803809263083583344839892978937261064733866047186745366252",
        "16306797999182958223339246724764982676247747592615248702199064066446117003029",
        "1"
      ],
      [
        "15609692914543574488525605840645746677300817734786221483276225148951969144559",
        "13537805642029017397787750172030608376639279609956698657405351578866062007258",
        "1"
      ],
      [
        "17070739525940965283226404081715954080473965307087097956690629517178573489062",
        "11298123213296432217846683876467583704158108436066356508195201337960691475535",
        "1"
      ],
      [
        "16600455355041582004072389377644758065196764223637201641330820983693795861005",
        "1126740767306709865005190677203491503268139482522544594435132252689235491717",
        "1"
      ],
      [
        "1753116852265107094903632058327229006683815666794761835433697948098769262864",
        "8256002018709783797080311060726663592396439888158850536409663334392119398521",
        "1"
      ],
      [
        "14884657965467110308388972144424487934644255232428892242266913497559286808507",
        "622738664344181694133305021045492345400993764170107699146080161400811806157",
        "1"
      ],
      [
        "17989943802590919009931091079099464407912150301053449713009289191112395717859",
        "13041282420842447357244840764204590485504533920831879183594333844589642891977",
        "1"
      ],
      [
        "192442491003421872227827929977546574266233914787330130660879117029033646320",
        "21670167474788252545152820163011398118902991779087624805079331156782939512952",
        "1"
      ],
      [
        "10041422758315244736300696757085118391082895778387086584507368456521719238026",
        "21222310210641179118127742148444784061602509140181096766819395043330602028596",
        "1"
      ],
      [
        "5543851875217390096510469381047765994901563396923042072330862252406073663794",
        "1476090747748713541801698843207451031405834033650082003133878187044190887203",
        "1"
      ],
      [
        "8291694446160146373897488528112129379506832112711958956291496996325621884775",
        "14467919249569267794226680266310976624398890567892525364189871054925109182876",
        "1"
      ],
      [
        "21812063088766438062093846739761935933075574048275894010962027164038229757473",
        "18033837946878174480681694750679359492742568245307460157094714992707404457074",
        "1"
      ],
      [
        "19216712417020373550036662271959470171068302231304530582343012376954299743330",
        "1349718155686218490749306906063347180661384712885015162181225502380770629330",
        "1"
      ],
      [
        "10873927746009381382071960426786537596867668927994136292426029546810096130857",
        "9984158610505438655332527797436159506095733282505334473879258094051819908065",
        "1"
      ],
      [
        "7734035772382422048084546768304515004280825164579584807649905656269463976542",
        "19708950177200088364210694360551721955995436664446994564732756318074241318137",
        "1"
      ],
      [
        "6091441466259084096630439140497407069926503821696729272150946977033178576290",
        "5602307861975531013204189771771176314461875861616031945485501446216898591446",
        "1"
      ],
      [
        "5160463707044082965211712978781139804378530736798569495276722629336717464756",
        "12130749952607123014452991731594848635114423945296843348497515314813439921518",
        "1"
      ],
      [
        "17844693616384903614334120596398230344025962402268135306900133104722031267918",
        "21405237546258878679957182026232138597306677887831330487539515165118891885313",
        "1"
      ],
      [
        "16880116716587826864491787213636353955669742328738978673088482463797683488683",
        "9994023020122347086011351906179677888180649000546896391497932655425200544548",
        "1"
      ],
      [
        "10887060399845665234804945437093859708158958924477759879743547812266346654867",
        "8872197666381389952754020856574052992422935928769394416607756770262168860600",
        "1"
      ],
      [
        "8787158013866073513265370590115853255524183486627363368513715174737227446549",
        "14766990747206105613587316265931797763703720589561415306451896743302868703337",
        "1"
      ],
      [
        "19046998539840728977643535798111806454043492483481502565256297532294412167331",
        "21819132389878454937730783906734651252978027538453753388167102949980850007818",
        "1"
      ],
      [
        "16386119208794143074146095638665725804532756232596350082723530720224992635509",
        "15049646259148967654023202479422987538760460166622676104149972419928969221743",
        "1"
      ],
      [
        "4405219439943921001936311283365570462051160270864162862248583572823141798026",
        "2307310495650296105801894054497065943783087219339752197458386681627692781852",
        "1"
      ],
      [
        "12516285429529712416736171240914804324337849995166333588105303946756011524553",
        "10491517343523507175361072694285643080873509677002365804425144206890972986556",
        "1"
      ],
      [
        "10804801657529282177404662005721720471858331554786904429928102991084092949055",
        "2878934095415065761042878308773519179285676976664555056962906347209697544577",
        "1"
      ],
      [
        "793946410887828456261718651135538537091971673386269848897485488386603314157",
        "12640244773392023120926435401505718602205726327138739021023234508538502320425",
        "1"
      ],
      [
        "19796634717690831324248254227891456618450693302142547641556738226535938857049",
        "13250507115426036046310740781307677517424194019086901246555543131670205866283",
        "1"
      ],
      [
        "13158394955882213600346976629573719101985539784033654160525637213737629373019",
        "16351396987993152749566984066234994161032191146991558180912663633632317829206",
        "1"
      ],
      [
        "11800252928443455101045874699471759083826372774272745281380501042174888216442",
        "18737298545038323901534166034165597641707734616382286031720201245261274691664",
        "1"
      ],
      [
        "5169741056728483301678774385984576396335900042063534011216726845691515123665",
        "10155145243544375314210200906998660002555600232374249664954714854555749308589",
        "1"
      ],
      [
        "949114234514474137609363255485184390664758798525174775376592515281870517381",
        "15104863141771812933925053693749650312092271121851484203429739671350017244619",
        "1"
      ],
      [
        "18896730392199816153037288349588671870764112523417216028707915561378869666527",
        "1461652854098383653033425669221338224322852733079313162141110039031626371702",
        "1"
      ],
      [
        "17461609855496243591519345398329931796112959472673485623758621395248213545649",
        "17283952975077071908227705279911306040333872642639590847336703810020586460672",
        "1"
      ],
      [
        "9903420335405489966303944366339257806188129945542765141639941829192465755600",
        "12485676561151323355101974037985693538201905512749185613388970871752551563658",
        "1"
      ],
      [
        "21703984820475630784994316067613878776704672152015114577280252842319383946726",
        "10202892030908602947311406416343399100950272115937605568002456744733887200596",
        "1"
      ],
      [
        "4717396269233922610240547576493176976901514357024109652960007971524573901736",
        "21656221997648835362457183264089219788998905139985285395013774568995585724550",
        "1"
      ],
      [
        "18475588975787547477978611779015701560296990569369446780243805573132658883231",
        "5946343085539193794016728738612360506842769725423206953337530847912724400526",
        "1"
      ],
      [
        "10109751107248895621935203038866936712567700350234523821155507782803834749468",
        "135867846373614596069212436384597637465654446853794096345118573603515744887",
        "1"
      ],
      [
        "11692961022466079276684019763802604772837013596214732525187851900744414836249",
        "8474537230995430034090208533999568892885554623720166476836254857913034059436",
        "1"
      ],
      [
        "8949451304612201020278088099542419688862030850624656647313723627299210043218",
        "7519652086785579500262355022669773682693476241488534968185815002336580322133",
        "1"
      ],
      [
        "1522878117977465501066909740618460740230420075854228282330022812735129664501",
        "13614768540955582419869033333700959506325932089993566802856552444443766633894",
        "1"
      ],
      [
        "10513256870547524959651538888055695947794595617156157588817269704813878646613",
        "7933370671900304034138414410150999140951607335759189615092555403342633584632",
        "1"
      ],
      [
        "18402528191003124997289671802467121587797622388278484442930799062034855181640",
        "5479031030983595329986484425620540485443985898848179006500343618431234021696",
        "1"
      ],
      [
        "18994009937673271752676539245293680611975857778763298443472438910446939875398",
        "1186369819572816892720072783889668786132162564092425841234079962714324377511",
        "1"
      ],
      [
        "10475261601786086141743094882282038459195520456658013748446022224794526943460",
        "4039165332370131766956365844007145304220949165212574797185904571864826244468",
        "1"
      ],
      [
        "3181963759730463855447182974839334930355592039773276780394041148885395013682",
        "2804164191303155869302803539263379597162539835939449566864048257905131330809",
        "1"
      ],
      [
        "6965616643471013864325632719616512563889749904752398162885579523982135399401",
        "3338613590412668798704951515461112813003786395122344597128522297013716600552",
        "1"
      ],
      [
        "15599912565238481476126846175853253860988398831044353312007707714142644243825",
        "192449097993064609257421284750280394529944423391598406365700556148530563824",
        "1"
      ],
      [
        "6573231078591069461095486773621588452233651399968689014270121413571906607534",
        "6532713266750244002000664158100569653260006505663962938387546488058215079310",
        "1"
      ],
      [
        "5518040253128519807312612015748219729945985747863396394664312356202584697696",
        "21327345629482707767129884621093463694872920818096153103334653117815063032714",
        "1"
      ],
      [
        "17033866652152067415093413157258059594232599100110374664544055420485823092129",
        "199565913900409246908098651556038782567937672219336405664551366775295514345",
        "1"
      ],
      [
        "3668053752916024046516206465843524732960940858690296618068466685812308192065",
        "8769686692328802611687831076313275687899219807172291065634037573271872477074",
        "1"
      ],
      [
        "2577963977516712974613516995689959794423472748833991929923741030401699283972",
        "370793764845782020152081293482807096972256662288113048776682330253549322582",
        "1"
      ],
      [
        "20441867360187522214009765205537429684193241611136764547280540393558428180819",
        "19508296066366561217719382906978518667720813825368979614551906017658533524739",
        "1"
      ],
      [
        "15846185247263489650047261024909253946543903046129162561522851357239661283138",
        "12980716163693821551483520709688781841577125867021537632547157893421007230035",
        "1"
      ],
      [
        "6175636684474006093352375161340649232701606809069087990786721048502271842998",
        "21339728590386072352316913074373412795763178904729008925382269521979603309117",
        "1"
      ],
      [
        "17313174633822395887507643347447763686631913265768594034035976077818265967461",
        "6249942114028217668449411164382819253202970898934684184757125104639479662464",
        "1"
      ],
      [
        "12807476885679045137426042558739216961912084155391140549198953173361259664742",
        "10859597670065873316032077577760708084318795319104692569119441085266914696661",
        "1"
      ],
      [
        "5554308491520084573769146584175194543995615417451200011045647070779058502636",
        "2471440486399629587302183373227599443866455136483254907577625326648989545393",
        "1"
      ],
      [
        "13977911877043849979990613457991088709770369104434083974800189429284674744693",
        "2454383579725594281354695885880954082133619410929877773600260501635363991687",
        "1"
      ],
      [
        "12356606381388573644095672728363883749284120766073280555303746053144143199501",
        "2397977491492258591243782271884368509388038882649945071355074823337269057931",
        "1"
      ]
    ]
  }`)

var vkeyData = vkeyJSON

func TestQueryProofVerify(t *testing.T) {
	f := SetupTest(t)

	// Add valid vkey to the keeper for successful tests
	validVKeyID, err := f.k.AddVKey(f.ctx, f.govModAddr, "email_auth_circuit", vkeyData, "Email authentication circuit")
	require.NoError(t, err)

	// Add an invalid vkey for error testing
	invalidVKey := []byte(`{
		"protocol": "groth16",
		"curve": "bn128",
		"nPublic": 2,
		"vk_alpha_1": ["1", "2", "1"],
		"vk_beta_2": [["3", "4"], ["5", "6"], ["1", "0"]],
		"vk_gamma_2": [["7", "8"], ["9", "10"], ["1", "0"]],
		"vk_delta_2": [["11", "12"], ["13", "14"], ["1", "0"]],
		"IC": [
			["15", "16", "1"],
			["17", "18", "1"],
			["19", "20", "1"]
		]
	}`)
	invalidVKeyID, err := f.k.AddVKey(f.ctx, f.govModAddr, "invalid_circuit", invalidVKey, "Invalid circuit for testing")
	require.NoError(t, err)

	testCases := []struct {
		name         string
		proofBz      []byte
		publicInputs []string
		vkeyName     string
		vkeyID       uint64
		shouldError  bool
		errorMsg     string
	}{
		{
			name:         "verify proof success with valid data using vkey name",
			proofBz:      proofData,
			publicInputs: publicInputs,
			vkeyName:     "email_auth_circuit",
			shouldError:  false,
		},
		{
			name:         "verify proof success with valid data using vkey ID",
			proofBz:      proofData,
			publicInputs: publicInputs,
			vkeyID:       validVKeyID,
			shouldError:  false,
		},
		{
			name:         "invalid proof data format",
			proofBz:      []byte("invalid-json-proof"),
			publicInputs: publicInputs,
			vkeyName:     "email_auth_circuit",
			shouldError:  true,
			errorMsg:     "failed to parse proof JSON",
		},
		{
			name:         "empty proof data",
			proofBz:      []byte{},
			publicInputs: publicInputs,
			vkeyName:     "email_auth_circuit",
			shouldError:  true,
			errorMsg:     "proof cannot be empty",
		},
		{
			name:         "non-existent vkey name",
			proofBz:      proofData,
			publicInputs: publicInputs,
			vkeyName:     "non_existent_circuit",
			shouldError:  true,
			errorMsg:     "not found",
		},
		{
			name:         "non-existent vkey ID",
			proofBz:      proofData,
			publicInputs: publicInputs,
			vkeyID:       9999,
			shouldError:  true,
			errorMsg:     "not found",
		},
		{
			name:         "neither vkey name nor ID provided",
			proofBz:      proofData,
			publicInputs: publicInputs,
			shouldError:  true,
			errorMsg:     "either vkey_name or vkey_id must be provided",
		},
		{
			name:         "mismatched public inputs count",
			proofBz:      proofData,
			publicInputs: []string{"1", "2"}, // Wrong number of inputs
			vkeyID:       validVKeyID,
			shouldError:  true,
			errorMsg:     "verification failed",
		},
		{
			name:         "empty public inputs",
			proofBz:      proofData,
			publicInputs: []string{},
			vkeyID:       validVKeyID,
			shouldError:  true,
			errorMsg:     "verification failed",
		},
		{
			name:         "invalid public input values",
			proofBz:      proofData,
			publicInputs: make([]string, len(publicInputs)), // Same count but all empty
			vkeyID:       validVKeyID,
			shouldError:  true,
			errorMsg:     "failed to parse public input",
		},
		{
			name:         "wrong vkey for proof",
			proofBz:      proofData,
			publicInputs: publicInputs,
			vkeyID:       invalidVKeyID, // Using wrong vkey
			shouldError:  true,
			errorMsg:     "invalid point",
		},
	}

	for _, tc := range testCases {
		t.Run(tc.name, func(t *testing.T) {
			req := &types.QueryVerifyRequest{
				Proof:        tc.proofBz,
				PublicInputs: tc.publicInputs,
			}

			// Set either vkey name or ID based on test case
			if tc.vkeyName != "" {
				req.VkeyName = tc.vkeyName
			}
			if tc.vkeyID != 0 {
				req.VkeyId = tc.vkeyID
			}

			res, err := f.queryServer.ProofVerify(f.ctx, req)

			if tc.shouldError {
				require.Error(t, err, "Expected error for test case: %s", tc.name)
				if tc.errorMsg != "" {
					require.Contains(t, err.Error(), tc.errorMsg, "Error message mismatch for test case: %s", tc.name)
				}
				require.Nil(t, res, "Response should be nil on error for test case: %s", tc.name)
			} else {
				require.NoError(t, err, "Unexpected error for test case: %s", tc.name)
				require.NotNil(t, res, "Response should not be nil for test case: %s", tc.name)
				require.True(t, res.Verified, "Proof should be verified for test case: %s", tc.name)
			}
		})
	}
}

// TestQueryProofVerifyWithStoredVKey tests the complete flow of storing a vkey and using it for verification
func TestQueryProofVerifyWithStoredVKey(t *testing.T) {
	f := SetupTest(t)

	// 1. Add vkey to keeper
	vkeyID, err := f.k.AddVKey(f.ctx, f.govModAddr, "email_auth", vkeyData, "Email authentication circuit")
	require.NoError(t, err)
	require.Equal(t, uint64(1), vkeyID)

	// 2. Verify it was stored correctly
	storedVKey, err := f.k.GetVKeyByName(f.ctx, "email_auth")
	require.NoError(t, err)
	require.Equal(t, "email_auth", storedVKey.Name)
	require.Equal(t, vkeyJSON, storedVKey.KeyBytes)

	// 3. Verify we can retrieve it as CircomVerificationKey
	circomVKey, err := f.k.GetCircomVKeyByName(f.ctx, "email_auth")
	require.NoError(t, err)
	require.NotNil(t, circomVKey)
	require.Equal(t, "groth16", circomVKey.Protocol)
	require.Equal(t, "bn128", circomVKey.Curve)
	require.Equal(t, 34, circomVKey.NPublic)

	// 4. Verify proof using the stored vkey by name
	reqByName := &types.QueryVerifyRequest{
		Proof:        proofData,
		PublicInputs: publicInputs,
		VkeyName:     "email_auth",
	}

	respByName, err := f.queryServer.ProofVerify(f.ctx, reqByName)
	require.NoError(t, err)
	require.NotNil(t, respByName)
	require.True(t, respByName.Verified)

	// 5. Verify proof using the stored vkey by ID
	reqByID := &types.QueryVerifyRequest{
		Proof:        proofData,
		PublicInputs: publicInputs,
		VkeyId:       vkeyID,
	}

	respByID, err := f.queryServer.ProofVerify(f.ctx, reqByID)
	require.NoError(t, err)
	require.NotNil(t, respByID)
	require.True(t, respByID.Verified)
}

// TestQueryProofVerifyMultipleVKeys tests verification with multiple stored vkeys
func TestQueryProofVerifyMultipleVKeys(t *testing.T) {
	f := SetupTest(t)

	// Add multiple vkeys
	vkey1ID, err := f.k.AddVKey(f.ctx, f.govModAddr, "circuit_1", vkeyData, "Circuit 1")
	require.NoError(t, err)

	vkey2ID, err := f.k.AddVKey(f.ctx, f.govModAddr, "circuit_2", vkeyData, "Circuit 2")
	require.NoError(t, err)

	vkey3ID, err := f.k.AddVKey(f.ctx, f.govModAddr, "circuit_3", vkeyData, "Circuit 3")
	require.NoError(t, err)

	// Verify proof with each vkey
	for i, vkeyID := range []uint64{vkey1ID, vkey2ID, vkey3ID} {
		t.Run(fmt.Sprintf("verify_with_vkey_%d", i+1), func(t *testing.T) {
			req := &types.QueryVerifyRequest{
				Proof:        proofData,
				PublicInputs: publicInputs,
				VkeyId:       vkeyID,
			}

			resp, err := f.queryServer.ProofVerify(f.ctx, req)
			require.NoError(t, err)
			require.NotNil(t, resp)
			require.True(t, resp.Verified)
		})
	}
}

// TestQueryProofVerifyNilRequest tests nil request handling
func TestQueryProofVerifyNilRequest(t *testing.T) {
	f := SetupTest(t)

	resp, err := f.queryServer.ProofVerify(f.ctx, nil)
	require.Error(t, err)
	require.Contains(t, err.Error(), "empty request")
	require.Nil(t, resp)
}

// ============================================================================
// VKey Query Tests
// ============================================================================

func TestQueryVKey(t *testing.T) {
	f := SetupTest(t)

	// Add a test vkey
	vkeyBytes := createTestVKeyBytes("test_key")
	id, err := f.k.AddVKey(f.ctx, f.govModAddr, "test_key", vkeyBytes, "Test verification key")
	require.NoError(t, err)

	tests := []struct {
		name        string
		req         *types.QueryVKeyRequest
		expectError bool
		errorMsg    string
	}{
		{
			name: "successfully query vkey by ID",
			req: &types.QueryVKeyRequest{
				Id: id,
			},
			expectError: false,
		},
		{
			name: "fail to query non-existent vkey",
			req: &types.QueryVKeyRequest{
				Id: 9999,
			},
			expectError: true,
			errorMsg:    "not found",
		},
		{
			name:        "nil request",
			req:         nil,
			expectError: true,
			errorMsg:    "empty request",
		},
	}

	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			resp, err := f.queryServer.VKey(f.ctx, tt.req)

			if tt.expectError {
				require.Error(t, err)
				require.Contains(t, err.Error(), tt.errorMsg)
				require.Nil(t, resp)
			} else {
				require.NoError(t, err)
				require.NotNil(t, resp)
				require.Equal(t, "test_key", resp.Vkey.Name)
				require.Equal(t, "Test verification key", resp.Vkey.Description)
			}
		})
	}
}

func TestQueryVKeyByName(t *testing.T) {
	f := SetupTest(t)

	// Add a test vkey
	vkeyBytes := createTestVKeyBytes("email_auth")
	expectedID, err := f.k.AddVKey(f.ctx, f.govModAddr, "email_auth", vkeyBytes, "Email authentication")
	require.NoError(t, err)

	tests := []struct {
		name        string
		req         *types.QueryVKeyByNameRequest
		expectError bool
		errorMsg    string
		expectedID  uint64
	}{
		{
			name: "successfully query vkey by name",
			req: &types.QueryVKeyByNameRequest{
				Name: "email_auth",
			},
			expectError: false,
			expectedID:  expectedID,
		},
		{
			name: "fail to query non-existent vkey",
			req: &types.QueryVKeyByNameRequest{
				Name: "non_existent",
			},
			expectError: true,
			errorMsg:    "not found",
		},
		{
			name: "fail with empty name",
			req: &types.QueryVKeyByNameRequest{
				Name: "",
			},
			expectError: true,
			errorMsg:    "name cannot be empty",
		},
		{
			name:        "nil request",
			req:         nil,
			expectError: true,
			errorMsg:    "empty request",
		},
	}

	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			resp, err := f.queryServer.VKeyByName(f.ctx, tt.req)

			if tt.expectError {
				require.Error(t, err)
				require.Contains(t, err.Error(), tt.errorMsg)
				require.Nil(t, resp)
			} else {
				require.NoError(t, err)
				require.NotNil(t, resp)
				require.Equal(t, "email_auth", resp.Vkey.Name)
				require.Equal(t, "Email authentication", resp.Vkey.Description)
				require.Equal(t, tt.expectedID, resp.Id)
			}
		})
	}
}

func TestQueryVKeys(t *testing.T) {
	f := SetupTest(t)

	// Test with empty store
	resp, err := f.queryServer.VKeys(f.ctx, &types.QueryVKeysRequest{})
	require.NoError(t, err)
	require.Empty(t, resp.Vkeys)

	// Add multiple vkeys
	for i := 0; i < 5; i++ {
		vkeyBytes := createTestVKeyBytes(fmt.Sprintf("key%d", i))
		_, err := f.k.AddVKey(f.ctx, f.govModAddr, fmt.Sprintf("key%d", i), vkeyBytes, fmt.Sprintf("Key %d", i))
		require.NoError(t, err)
	}

	tests := []struct {
		name          string
		req           *types.QueryVKeysRequest
		expectedCount int
		expectError   bool
		errorMsg      string
	}{
		{
			name:          "query all vkeys without pagination",
			req:           &types.QueryVKeysRequest{},
			expectedCount: 5,
			expectError:   false,
		},
		{
			name: "query with pagination - first page",
			req: &types.QueryVKeysRequest{
				Pagination: &query.PageRequest{
					Limit: 2,
				},
			},
			expectedCount: 2,
			expectError:   false,
		},
		{
			name: "query with pagination - offset",
			req: &types.QueryVKeysRequest{
				Pagination: &query.PageRequest{
					Offset: 2,
					Limit:  2,
				},
			},
			expectedCount: 2,
			expectError:   false,
		},
		{
			name: "query with pagination - large offset",
			req: &types.QueryVKeysRequest{
				Pagination: &query.PageRequest{
					Offset: 10,
					Limit:  2,
				},
			},
			expectedCount: 0,
			expectError:   false,
		},
		{
			name:        "nil request",
			req:         nil,
			expectError: true,
			errorMsg:    "empty request",
		},
	}

	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			resp, err := f.queryServer.VKeys(f.ctx, tt.req)

			if tt.expectError {
				require.Error(t, err)
				require.Contains(t, err.Error(), tt.errorMsg)
				require.Nil(t, resp)
			} else {
				require.NoError(t, err)
				require.NotNil(t, resp)
				require.Len(t, resp.Vkeys, tt.expectedCount)

				// Verify structure
				for _, vkeyWithID := range resp.Vkeys {
					require.NotEmpty(t, vkeyWithID.Vkey.Name)
					require.NotEmpty(t, vkeyWithID.Vkey.KeyBytes)
					require.GreaterOrEqual(t, vkeyWithID.Id, uint64(0))
				}
			}
		})
	}
}

func TestQueryVKeysPagination(t *testing.T) {
	f := SetupTest(t)

	// Add 10 vkeys
	totalVKeys := 10
	for i := 0; i < totalVKeys; i++ {
		vkeyBytes := createTestVKeyBytes(fmt.Sprintf("key%d", i))
		_, err := f.k.AddVKey(f.ctx, f.govModAddr, fmt.Sprintf("key%d", i), vkeyBytes, fmt.Sprintf("Key %d", i))
		require.NoError(t, err)
	}

	// Test pagination - get all items in pages of 3
	var allVKeys []types.VKeyWithID
	var nextKey []byte
	pageSize := uint64(3)

	for {
		resp, err := f.queryServer.VKeys(f.ctx, &types.QueryVKeysRequest{
			Pagination: &query.PageRequest{
				Key:   nextKey,
				Limit: pageSize,
			},
		})
		require.NoError(t, err)
		require.NotNil(t, resp)

		allVKeys = append(allVKeys, resp.Vkeys...)

		if resp.Pagination.NextKey == nil {
			break
		}
		nextKey = resp.Pagination.NextKey
	}

	// Should have retrieved all 10 vkeys
	require.Len(t, allVKeys, totalVKeys)

	// Verify all names are unique
	names := make(map[string]bool)
	for _, vkey := range allVKeys {
		require.False(t, names[vkey.Vkey.Name], "duplicate vkey name: %s", vkey.Vkey.Name)
		names[vkey.Vkey.Name] = true
	}
}

func TestQueryHasVKey(t *testing.T) {
	f := SetupTest(t)

	// Add a test vkey
	vkeyBytes := createTestVKeyBytes("test_key")
	expectedID, err := f.k.AddVKey(f.ctx, f.govModAddr, "test_key", vkeyBytes, "Test key")
	require.NoError(t, err)

	tests := []struct {
		name           string
		req            *types.QueryHasVKeyRequest
		expectError    bool
		errorMsg       string
		expectedExists bool
		expectedID     uint64
	}{
		{
			name: "vkey exists",
			req: &types.QueryHasVKeyRequest{
				Name: "test_key",
			},
			expectError:    false,
			expectedExists: true,
			expectedID:     expectedID,
		},
		{
			name: "vkey does not exist",
			req: &types.QueryHasVKeyRequest{
				Name: "non_existent",
			},
			expectError:    false,
			expectedExists: false,
			expectedID:     0,
		},
		{
			name: "empty name",
			req: &types.QueryHasVKeyRequest{
				Name: "",
			},
			expectError: true,
			errorMsg:    "name cannot be empty",
		},
		{
			name:        "nil request",
			req:         nil,
			expectError: true,
			errorMsg:    "empty request",
		},
	}

	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			resp, err := f.queryServer.HasVKey(f.ctx, tt.req)

			if tt.expectError {
				require.Error(t, err)
				require.Contains(t, err.Error(), tt.errorMsg)
				require.Nil(t, resp)
			} else {
				require.NoError(t, err)
				require.NotNil(t, resp)
				require.Equal(t, tt.expectedExists, resp.Exists)
				require.Equal(t, tt.expectedID, resp.Id)
			}
		})
	}
}

func TestQueryNextVKeyID(t *testing.T) {
	f := SetupTest(t)

	t.Run("query next vkey id on empty store", func(t *testing.T) {
		resp, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
		require.NoError(t, err)
		require.NotNil(t, resp)
		// Initial sequence value after setup (SetupTest calls NextVKeyID.Next once)
		require.GreaterOrEqual(t, resp.NextId, uint64(1))
	})

	t.Run("next id increments after adding vkey", func(t *testing.T) {
		// Get initial next ID
		initialResp, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
		require.NoError(t, err)
		initialNextID := initialResp.NextId

		// Add a vkey
		vkeyBytes := createTestVKeyBytes("key1")
		_, err = f.k.AddVKey(f.ctx, f.govModAddr, "key1", vkeyBytes, "Key 1")
		require.NoError(t, err)

		// Check next ID has incremented
		resp, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
		require.NoError(t, err)
		require.Equal(t, initialNextID+1, resp.NextId)
	})

	t.Run("next id increments correctly after multiple additions", func(t *testing.T) {
		// Get current next ID
		beforeResp, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
		require.NoError(t, err)
		beforeNextID := beforeResp.NextId

		// Add multiple vkeys
		numToAdd := 4
		for i := 0; i < numToAdd; i++ {
			vkeyBytes := createTestVKeyBytes(fmt.Sprintf("multi_key%d", i))
			_, err := f.k.AddVKey(f.ctx, f.govModAddr, fmt.Sprintf("multi_key%d", i), vkeyBytes, fmt.Sprintf("Multi Key %d", i))
			require.NoError(t, err)
		}

		// Get next ID after adding vkeys
		afterResp, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
		require.NoError(t, err)
		require.Equal(t, beforeNextID+uint64(numToAdd), afterResp.NextId)
	})

	t.Run("query does not consume sequence (peek behavior)", func(t *testing.T) {
		// Query next ID multiple times
		resp1, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
		require.NoError(t, err)

		resp2, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
		require.NoError(t, err)

		resp3, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
		require.NoError(t, err)

		// All responses should be the same (query doesn't consume the sequence)
		require.Equal(t, resp1.NextId, resp2.NextId)
		require.Equal(t, resp2.NextId, resp3.NextId)
	})

	t.Run("next id unchanged after vkey removal", func(t *testing.T) {
		// Add a vkey to remove
		vkeyBytes := createTestVKeyBytes("to_remove")
		_, err := f.k.AddVKey(f.ctx, f.govModAddr, "to_remove", vkeyBytes, "To Remove")
		require.NoError(t, err)

		// Get next ID before removal
		beforeResp, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
		require.NoError(t, err)
		beforeNextID := beforeResp.NextId

		// Remove the vkey
		err = f.k.RemoveVKey(f.ctx, f.govModAddr, "to_remove")
		require.NoError(t, err)

		// Next ID should remain unchanged after removal
		afterResp, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
		require.NoError(t, err)
		require.Equal(t, beforeNextID, afterResp.NextId)
	})

	t.Run("nil request returns error", func(t *testing.T) {
		resp, err := f.queryServer.NextVKeyID(f.ctx, nil)
		require.Error(t, err)
		require.Contains(t, err.Error(), "empty request")
		require.Nil(t, resp)
	})
}

func TestQueryNextVKeyIDPredictability(t *testing.T) {
	f := SetupTest(t)

	// Test that NextVKeyID correctly predicts the ID that will be assigned
	for i := 0; i < 5; i++ {
		// Get predicted next ID
		predResp, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
		require.NoError(t, err)
		predictedID := predResp.NextId

		// Add vkey and get actual ID
		vkeyBytes := createTestVKeyBytes(fmt.Sprintf("predict_key%d", i))
		actualID, err := f.k.AddVKey(f.ctx, f.govModAddr, fmt.Sprintf("predict_key%d", i), vkeyBytes, fmt.Sprintf("Predict Key %d", i))
		require.NoError(t, err)

		// Verify prediction was correct
		require.Equal(t, predictedID, actualID, "NextVKeyID should correctly predict the ID for the next vkey")
	}
}

func TestQueryNextVKeyIDAfterGenesis(t *testing.T) {
	f := SetupTest(t)

	// Initialize genesis with vkeys that have high IDs
	gs := &types.GenesisState{
		Vkeys: []types.VKeyWithID{
			{
				Id: 50,
				Vkey: types.VKey{
					Name:        "genesis_key_50",
					Description: "Genesis key with ID 50",
					KeyBytes:    createTestVKeyBytes("genesis_key_50"),
				},
			},
			{
				Id: 100,
				Vkey: types.VKey{
					Name:        "genesis_key_100",
					Description: "Genesis key with ID 100",
					KeyBytes:    createTestVKeyBytes("genesis_key_100"),
				},
			},
		},
	}

	f.k.InitGenesis(f.ctx, gs)

	// Query next ID - should be 101 (one after highest genesis ID)
	resp, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
	require.NoError(t, err)
	require.Equal(t, uint64(101), resp.NextId)

	// Add a new key and verify it gets ID 101
	vkeyBytes := createTestVKeyBytes("new_key_after_genesis")
	newID, err := f.k.AddVKey(f.ctx, f.govModAddr, "new_key_after_genesis", vkeyBytes, "New key after genesis")
	require.NoError(t, err)
	require.Equal(t, uint64(101), newID)

	// Next ID should now be 102
	resp, err = f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
	require.NoError(t, err)
	require.Equal(t, uint64(102), resp.NextId)
}

func TestQueryNextVKeyIDSequential(t *testing.T) {
	f := SetupTest(t)

	// Get initial next ID
	initialResp, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
	require.NoError(t, err)
	startID := initialResp.NextId

	// Add vkeys and verify IDs are sequential
	numVKeys := 10
	for i := 0; i < numVKeys; i++ {
		expectedID := startID + uint64(i)

		// Verify NextVKeyID returns expected ID
		resp, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
		require.NoError(t, err)
		require.Equal(t, expectedID, resp.NextId)

		// Add vkey
		vkeyBytes := createTestVKeyBytes(fmt.Sprintf("seq_key%d", i))
		actualID, err := f.k.AddVKey(f.ctx, f.govModAddr, fmt.Sprintf("seq_key%d", i), vkeyBytes, fmt.Sprintf("Seq Key %d", i))
		require.NoError(t, err)
		require.Equal(t, expectedID, actualID)
	}

	// Final next ID should be startID + numVKeys
	finalResp, err := f.queryServer.NextVKeyID(f.ctx, &types.QueryNextVKeyIDRequest{})
	require.NoError(t, err)
	require.Equal(t, startID+uint64(numVKeys), finalResp.NextId)
}

func TestQueryParams(t *testing.T) {
	f := SetupTest(t)

	customParams := types.Params{
		MaxVkeySizeBytes: 1024,
		UploadChunkSize:  32,
		UploadChunkGas:   500,
	}
	err := f.k.Params.Set(f.ctx, customParams)
	require.NoError(t, err)

	resp, err := f.queryServer.Params(f.ctx, &types.QueryParamsRequest{})
	require.NoError(t, err)
	require.Equal(t, customParams, resp.Params)
}
